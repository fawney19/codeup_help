import{k as Re,u as Oe,r as m,l as A,o as Fe,q as Le,s as Ve,c as l,a as r,b as t,f as p,x as Ne,t as b,m as o,h as u,p as n,F as U,d as H,g as ae,v as re,w as Be,y as Ee,T as Pe,z as Ue,i as He,A as qe,B as Ge,j as Ye,n as We}from"./index-XUB9a-8Y.js";import{c as x,_ as Ze,C as V,A as oe}from"./clock-D8CgLCDh.js";/**
 * @license lucide-vue-next v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pe=x("calendar-days",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]);/**
 * @license lucide-vue-next v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=x("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-vue-next v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xe=x("chart-column",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-vue-next v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Je=x("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-vue-next v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ke=x("copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-vue-next v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qe=x("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]);/**
 * @license lucide-vue-next v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=x("file-text",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-vue-next v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const et=x("folder-minus",[["path",{d:"M9 13h6",key:"1uhe8q"}],["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]);/**
 * @license lucide-vue-next v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tt=x("folder-open",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]);/**
 * @license lucide-vue-next v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const st=x("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-vue-next v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const at=x("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);/**
 * @license lucide-vue-next v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=x("sparkles",[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]]);/**
 * @license lucide-vue-next v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rt=x("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]]);/**
 * @license lucide-vue-next v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=x("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),ot=(G,f)=>{const Y=G.__vccOpts||G;for(const[M,I]of f)Y[M]=I;return Y},lt={class:"min-h-screen bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50"},nt={class:"border-b-4 border-black bg-brutal-cyan"},ct={class:"max-w-7xl mx-auto px-6 py-8"},it={class:"flex justify-between items-center"},dt={class:"bg-blue-600 text-white px-3 py-1 inline-block mt-2 font-bold text-sm"},ut={class:"flex items-center"},bt={class:"max-w-7xl mx-auto py-6 px-6"},pt={class:"bg-brutal-yellow border-4 border-blue-600 shadow-brutal p-6 mb-8"},ht={class:"text-2xl font-black text-gray-800 uppercase mb-4 flex items-center"},vt={class:"flex flex-wrap gap-4"},mt=["onClick"],xt={class:"mt-6 flex flex-wrap gap-4"},yt={class:"block text-lg font-black text-gray-800 uppercase mb-2 flex items-center"},ft={class:"block text-lg font-black text-gray-800 uppercase mb-2 flex items-center"},gt={class:"flex items-end"},wt={key:0,class:"bg-brutal-pink border-4 border-blue-600 shadow-brutal p-6 mb-8"},kt={class:"flex justify-between items-start mb-6"},_t={class:"text-2xl font-black text-gray-800 uppercase flex items-center"},Dt=["disabled"],Ct={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},jt={class:"bg-brutal-cyan border-4 border-blue-600 text-center p-4"},Mt={class:"text-3xl font-black text-gray-800"},$t={class:"bg-brutal-green border-4 border-blue-600 text-center p-4"},Tt={class:"text-3xl font-black text-gray-800"},St={class:"bg-brutal-yellow border-4 border-blue-600 text-center p-4"},It={class:"text-3xl font-black text-gray-800"},At={class:"bg-brutal-orange border-4 border-blue-600 text-center p-4"},zt={class:"text-3xl font-black text-gray-800"},Rt={class:"bg-white border-4 border-blue-600 shadow-brutal-lg p-6"},Ot={class:"flex justify-between items-center mb-6"},Ft={class:"text-2xl font-black text-gray-800 uppercase flex items-center"},Lt={key:0,class:"flex items-center space-x-4"},Vt={key:0,class:"text-center py-12"},Nt={class:"bg-brutal-yellow border-4 border-blue-600 shadow-brutal p-6 inline-block"},Bt={class:"text-xl font-black text-gray-800 uppercase mb-2 flex items-center justify-center"},Et={key:1,class:"text-center py-12"},Pt={key:2,class:"space-y-6"},Ut=["onClick"],Ht={class:"flex items-center"},qt={class:"w-6 h-6 bg-blue-600 text-white flex items-center justify-center font-black mr-3"},Gt={class:"bg-brutal-pink border-2 border-blue-600 px-4 py-2 font-black text-gray-800 text-sm uppercase"},Yt={class:"ml-4 bg-blue-600 text-white px-2 py-1 font-bold text-xs uppercase"},Wt={key:0,class:"pl-4 border-l-4 border-black space-y-4 transition-all duration-200"},Zt={class:"absolute -left-8 w-8 h-8 bg-brutal-green border-2 border-blue-600 flex items-center justify-center font-black text-gray-800 text-xs"},Xt={class:"flex justify-between items-start"},Jt={class:"flex-1"},Kt={class:"flex items-center space-x-2"},Qt={class:"text-sm font-medium text-gray-900"},es={class:"text-sm text-gray-500"},ts={key:0,class:"mt-1 text-sm text-gray-600"},ss={key:1,class:"mt-2 space-y-1"},as={class:"font-bold mb-1"},rs={class:"whitespace-pre-wrap"},os={key:0,class:"text-xs text-gray-400"},ls={class:"ml-4 text-right flex-shrink-0"},ns={class:"text-xs text-gray-500"},cs={key:0,class:"text-xs text-gray-400 mt-1"},is={class:"bg-brutal-yellow border-b-4 border-blue-600 p-6 flex items-center justify-between"},ds={class:"text-2xl font-black text-gray-800 uppercase flex items-center"},us={class:"flex items-center space-x-3"},bs=["disabled"],ps={class:"flex-1 overflow-auto p-6 bg-white"},hs={key:0,class:"flex flex-col items-center space-y-6"},vs={class:"bg-brutal-pink border-4 border-blue-600 shadow-brutal px-6 py-3 transform -rotate-1"},ms={class:"text-sm text-gray-800 font-black uppercase flex items-center justify-center"},xs={class:"bg-brutal-cyan border-4 border-blue-600 shadow-brutal px-6 py-3 transform rotate-1"},ys={class:"text-sm text-gray-800 font-black uppercase flex items-center justify-center"},fs={class:"w-full max-w-2xl"},gs={class:"bg-brutal-green border-4 border-blue-600 shadow-brutal p-6"},ws={class:"text-lg font-black text-gray-800 uppercase mb-4 flex items-center"},ks={class:"bg-brutal-yellow border-4 border-blue-600 shadow-brutal p-8 inline-block transform rotate-1 hover:-rotate-1 transition-transform duration-300"},_s={class:"text-2xl font-black text-gray-800 uppercase mb-4 flex items-center justify-center"},Ds={class:"text-xs text-gray-600 font-bold flex items-center justify-center"},Cs={key:1,class:"text-center py-12"},js={class:"bg-brutal-cyan border-4 border-blue-600 shadow-brutal p-8 inline-block transform -rotate-1"},Ms={class:"mt-4 text-gray-800 font-black uppercase flex items-center justify-center"},$s={key:0,class:"mt-2 text-sm text-gray-600 font-bold flex items-center justify-center"},Ts={key:2,class:"space-y-6"},Ss={class:"bg-brutal-pink border-4 border-blue-600 shadow-brutal p-4 flex items-center justify-between transform rotate-1"},Is={class:"text-xl font-black text-gray-800 uppercase flex items-center"},As={class:"flex items-center space-x-4 mt-2 text-sm font-bold text-gray-600"},zs={key:0,class:"bg-blue-600 text-white px-2 py-1 rounded flex items-center"},Rs={key:1,class:"bg-blue-600 text-white px-2 py-1 rounded flex items-center"},Os={class:"flex space-x-2"},Fs={key:0,class:"flex flex-col items-center justify-center py-12"},Ls={class:"text-gray-800 font-bold text-sm mt-4 flex items-center justify-center"},Vs={key:0,class:"text-gray-600 font-bold text-xs mt-2 flex items-center justify-center"},Ns={key:1,class:"whitespace-pre-wrap font-mono text-sm text-gray-800 leading-relaxed"},Bs={class:"fixed top-4 right-4 z-[99999] space-y-2"},Es={class:"flex items-center px-4 py-3"},Ps={class:"flex-shrink-0"},Us={class:"ml-3 flex-1"},Hs={class:"text-sm font-black text-gray-800 uppercase"},qs={class:"ml-2"},Gs=["onClick"],Ys={__name:"ProjectDetail",props:{id:{type:[String,Number],required:!0},name:{type:String,required:!1}},setup(G){const f=G;Ge();const Y=He(),M=Re();Oe();const I=m("week"),g=m(""),w=m(""),K=m(""),h=m(""),_=m(!1),N=m(null),$=m(null),D=m(null),Q=m(!1),T=m(new Set),B=m(""),he=m(null),W=m([]);let ve=0;const me=[{value:"today",label:"今天",icon:V},{value:"week",label:"本周",icon:X},{value:"month",label:"本月",icon:pe},{value:"year",label:"今年",icon:pe}],ee=A(()=>M.currentProject),C=A(()=>M.activities),xe=A(()=>M.loading),ne=A(()=>f.name?decodeURIComponent(f.name):ee.value?.overview?.name||"加载中..."),Z=m(new Date),z=A(()=>{if(!N.value)return null;if(_.value){const a=((Z.value-N.value)/1e3).toFixed(1);return`${parseFloat(a)}秒`}else if($.value){const e=(($.value-N.value)/1e3).toFixed(1);return`${parseFloat(e)}秒`}return null}),R=A(()=>{const s={};return C.value.forEach(e=>{const a=new Date(e.created_at).toDateString();s[a]||(s[a]=[]),s[a].push(e)}),Object.keys(s).forEach(e=>{s[e].sort((a,d)=>new Date(d.created_at)-new Date(a.created_at))}),s}),O=A(()=>{if(!C.value.length)return null;const s=C.value.filter(c=>c.action?.includes("push")).length,e=C.value.reduce((c,i)=>c+(i.commits?.length||0),0),a=Object.keys(R.value).length,d=C.value.reduce((c,i)=>c+(i.commits?.reduce((j,v)=>j+(v.added||0)+(v.modified||0)+(v.removed||0),0)||0),0);return{pushCount:s,commitCount:e,fileChanges:d,activeDays:a}}),ye=s=>{const e=new Date(s),a=new Date,d=new Date(a);return d.setDate(d.getDate()-1),e.toDateString()===a.toDateString()?"今天":e.toDateString()===d.toDateString()?"昨天":e.toLocaleDateString("zh-CN",{year:"numeric",month:"long",day:"numeric",weekday:"long"})},ce=s=>new Date(s).toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"}),te=s=>{const e=new Date,a=d=>{const c=d.getFullYear(),i=String(d.getMonth()+1).padStart(2,"0"),j=String(d.getDate()).padStart(2,"0");return`${c}-${i}-${j}`};switch(s){case"today":g.value=a(e),w.value=a(e);break;case"week":const d=new Date(e),c=e.getDay(),i=c===0?6:c-1;d.setDate(e.getDate()-i),g.value=a(d),w.value=a(e);break;case"month":const j=new Date(e.getFullYear(),e.getMonth(),1);g.value=a(j),w.value=a(e);break;case"year":const v=new Date(e.getFullYear(),0,1);g.value=a(v),w.value=a(e);break}},fe=s=>{I.value=s,te(s),F()},F=async()=>{const s=f.id;if(!g.value||!w.value){console.warn("开始日期或结束日期为空，跳过加载");return}try{const e=await M.fetchActivities(s,{start_date:g.value,end_date:w.value});K.value="",h.value=""}catch(e){console.error("Failed to load activities:",e)}},ge=()=>{if(!C.value.length)return;const{pushCount:s,commitCount:e,fileChanges:a,activeDays:d}=O.value;let i=`${de()}活动小结：

`;i+=`统计概览：
`,i+=`• 推送次数：${s} 次
`,i+=`• 提交数量：${e} 个
`,i+=`• 文件变更：${a} 处
`,i+=`• 活跃天数：${d} 天

`;const j={};Object.entries(R.value).forEach(([v,y])=>{const E=y.filter(P=>P.action?.includes("Push")).length,k=y.reduce((P,se)=>P+(se.commits?.length||0),0);j[v]={pushes:E,commits:k,activities:y}}),i+=`每日统计：
`,Object.entries(j).sort(([v],[y])=>new Date(y)-new Date(v)).forEach(([v,y])=>{const E=new Date(v).toLocaleDateString("zh-CN",{year:"numeric",month:"long",day:"numeric",weekday:"long"});i+=`• ${E}：推送 ${y.pushes} 次，提交 ${y.commits} 个
`}),i+=`
`,i+=`详细提交记录：
`,Object.entries(j).sort(([v],[y])=>new Date(y)-new Date(v)).forEach(([v,y])=>{const E=new Date(v).toLocaleDateString("zh-CN",{year:"numeric",month:"long",day:"numeric",weekday:"long"});i+=`
=== ${E} ===
`,y.activities.forEach((k,P)=>{const se=ce(k.created_at);i+=`
${P+1}. [${se}] ${k.action||"Push"} to ${k.target_title||k.ref_name||"master"}
`,k.note&&(i+=`   备注: ${k.note}
`),k.commits&&k.commits.length>0&&(i+=`   提交内容:
`,k.commits.forEach((S,ze)=>{i+=`   ${ze+1}) ${S.id?.substring(0,7)} - ${S.message||"无提交信息"}
`,S.author&&typeof S.author=="string"?i+=`      作者: ${S.author}
`:S.author&&S.author.name&&(i+=`      作者: ${S.author.name}
`)}))})}),K.value=i},we=()=>{Q.value=!0,Z.value=new Date},ie=()=>{Q.value=!1},ke=s=>s?s.replace(/#{1,6}\s+/g,"").replace(/\*\*(.*?)\*\*/g,"$1").replace(/\*(.*?)\*/g,"$1").replace(/`(.*?)`/g,"$1").replace(/\[([^\]]*)\]\([^)]*\)/g,"$1").replace(/^\s*[-*+]\s+/gm,"• ").replace(/\n\s*\n/g,`

`).trim():"",de=()=>{if(g.value&&w.value)switch(I.value){case"today":return"今日";case"week":return"本周";case"month":return"本月";case"year":return"今年";default:return`${g.value} 至 ${w.value}`}return"时间范围未设置"},_e=()=>{_.value||(h.value="",N.value=null,$.value=null,Z.value=new Date,D.value&&(clearInterval(D.value),D.value=null),De())},De=async()=>{if(C.value.length&&!_.value)try{_.value=!0,h.value="",N.value=new Date,$.value=null,D.value=setInterval(()=>{Z.value=new Date},100),ge();let s=`项目：${ne.value}
时间范围：${de()}
活动总结：${K.value}`;B.value&&B.value.trim()&&(s+=`

用户补充信息：
${B.value.trim()}`);const e={project_id:parseInt(f.id),report_type:"activity_summary",time_range:"custom",start_date:g.value,end_date:w.value,additional_context:s,response_mode:"blocking",user:"frontend_user"},a=await qe.generateAIReportBlocking(f.id,e);a&&a.data&&a.data.answer&&(h.value=a.data.answer,$.value=new Date,D.value&&(clearInterval(D.value),D.value=null))}catch(s){console.error("AI报告生成失败:",s),h.value=`## 报告生成失败

很抱歉，AI报告生成过程中出现了错误：${s.message}

请稍后重试，或联系系统管理员。

---
*错误时间：${new Date().toLocaleString("zh-CN")}*`,$.value=new Date}finally{_.value=!1,D.value&&(clearInterval(D.value),D.value=null)}},Ce=(s,e="success")=>{const a={id:++ve,message:s,type:e,timestamp:Date.now()};W.value.push(a),console.log("Toast添加:",s),setTimeout(()=>{ue(a.id)},4e3)},ue=s=>{const e=W.value.findIndex(a=>a.id===s);e>-1&&(W.value.splice(e,1),console.log("Toast移除:",s))},L=s=>{Ce(s,"success")},je=async()=>{try{if(!h.value){L("暂无报告内容可复制");return}await navigator.clipboard.writeText(h.value),L("报告已复制到剪贴板")}catch(s){console.error("复制失败:",s),L("复制失败，请重试")}},Me=async()=>{try{if(!h.value){L("暂无报告内容可复制");return}const s=ke(h.value);await navigator.clipboard.writeText(s),L("文本已复制到剪贴板")}catch(s){console.error("复制失败:",s),L("复制失败，请重试")}},$e=()=>{const s=new Blob([h.value],{type:"text/markdown;charset=utf-8"}),e=URL.createObjectURL(s),a=document.createElement("a");a.href=e,a.download=`项目活动报告_${f.id}_${new Date().toISOString().split("T")[0]}.md`,a.click(),URL.revokeObjectURL(e)},Te=s=>{T.value.has(s)?T.value.delete(s):T.value.add(s)},be=s=>T.value.has(s),Se=()=>{T.value=new Set(Object.keys(R.value))},Ie=()=>{T.value.clear()},Ae=()=>{Y.push("/")};return Fe(()=>{f.id&&(te(I.value),ee.value?.overview||M.fetchProjectOverview(f.id),F())}),Le(()=>{}),Ve(()=>f.id,s=>{s&&(te(I.value),M.fetchProjectOverview(s),F())}),(s,e)=>(r(),l("div",lt,[t("header",nt,[t("div",ct,[t("div",it,[t("div",null,[t("h1",{class:"text-4xl font-black text-gray-800 uppercase cursor-pointer hover:bg-brutal-yellow hover:px-2 transition-all",onClick:Ae},b(ne.value),1),t("div",dt,b(ee.value?.overview?.description||"项目活动时间线"),1)]),t("div",ut,[o(Ze)])])])]),t("main",bt,[t("div",pt,[t("h2",ht,[o(n(V),{class:"w-6 h-6 mr-3 text-blue-600"}),e[4]||(e[4]=u(" 时间筛选器 ",-1))]),t("div",vt,[(r(),l(U,null,H(me,a=>t("button",{key:a.value,onClick:d=>fe(a.value),class:Ye(["border-4 border-blue-600 px-4 py-2 font-black text-gray-800 uppercase transition-all hover:transform hover:scale-105",I.value===a.value?"bg-blue-600 text-brutal-yellow shadow-brutal-sm":"bg-white hover:bg-brutal-pink"])},b(a.label),11,mt)),64))]),t("div",xt,[t("div",null,[t("label",yt,[o(n(X),{class:"w-5 h-5 mr-2 text-blue-600"}),e[5]||(e[5]=u(" 开始日期 ",-1))]),ae(t("input",{type:"date","onUpdate:modelValue":e[0]||(e[0]=a=>g.value=a),onChange:F,class:"border-4 border-blue-600 px-3 py-2 font-bold focus:outline-none focus:bg-brutal-cyan"},null,544),[[re,g.value]])]),t("div",null,[t("label",ft,[o(n(X),{class:"w-5 h-5 mr-2 text-blue-600"}),e[6]||(e[6]=u(" 结束日期 ",-1))]),ae(t("input",{type:"date","onUpdate:modelValue":e[1]||(e[1]=a=>w.value=a),onChange:F,class:"border-4 border-blue-600 px-3 py-2 font-bold focus:outline-none focus:bg-brutal-cyan"},null,544),[[re,w.value]])]),t("div",gt,[t("button",{onClick:F,class:"bg-brutal-green border-4 border-blue-600 shadow-brutal px-6 py-2 font-black text-gray-800 uppercase hover:transform hover:translate-x-1 hover:translate-y-1 hover:shadow-none transition-all"},[o(n(at),{class:"w-5 h-5 mr-2"}),e[7]||(e[7]=u(" 查询 ",-1))])])])]),O.value?(r(),l("div",wt,[t("div",kt,[t("h2",_t,[o(n(Xe),{class:"w-6 h-6 mr-3 text-blue-600"}),e[8]||(e[8]=u(" 活动概览 ",-1))]),t("button",{onClick:we,disabled:!C.value.length,class:"bg-brutal-orange border-4 border-blue-600 shadow-brutal px-4 py-2 font-black text-gray-800 uppercase hover:transform hover:scale-105 transition-all disabled:opacity-50"},[o(n(q),{class:"w-5 h-5 mr-2"}),e[9]||(e[9]=u(" 生成AI报告 ",-1))],8,Dt)]),t("div",Ct,[t("div",jt,[t("div",Mt,b(O.value.pushCount),1),e[10]||(e[10]=t("div",{class:"text-sm font-bold text-gray-800 uppercase"},"推送次数",-1))]),t("div",$t,[t("div",Tt,b(O.value.commitCount),1),e[11]||(e[11]=t("div",{class:"text-sm font-bold text-gray-800 uppercase"},"提交数量",-1))]),t("div",St,[t("div",It,b(O.value.fileChanges),1),e[12]||(e[12]=t("div",{class:"text-sm font-bold text-gray-800 uppercase"},"文件变更",-1))]),t("div",At,[t("div",zt,b(O.value.activeDays),1),e[13]||(e[13]=t("div",{class:"text-sm font-bold text-gray-800 uppercase"},"活跃天数",-1))])])])):p("",!0),t("div",Rt,[t("div",Ot,[t("h2",Ft,[o(n(rt),{class:"w-6 h-6 mr-3 text-blue-600"}),e[14]||(e[14]=u(" 活动时间线 ",-1))]),Object.keys(R.value).length>0?(r(),l("div",Lt,[T.value.size<Object.keys(R.value).length?(r(),l("button",{key:0,onClick:Se,class:"bg-brutal-cyan border-4 border-blue-600 px-3 py-1 font-black text-gray-800 text-sm uppercase hover:bg-brutal-pink transition-colors"},[o(n(et),{class:"w-4 h-4 mr-2"}),e[15]||(e[15]=u(" 全部收缩 ",-1))])):p("",!0),T.value.size>0?(r(),l("button",{key:1,onClick:Ie,class:"bg-brutal-green border-4 border-blue-600 px-3 py-1 font-black text-gray-800 text-sm uppercase hover:bg-brutal-yellow transition-colors"},[o(n(tt),{class:"w-4 h-4 mr-2"}),e[16]||(e[16]=u(" 全部展开 ",-1))])):p("",!0)])):p("",!0)]),xe.value?(r(),l("div",Vt,[t("div",Nt,[t("div",Bt,[o(n(st),{class:"w-6 h-6 mr-3 animate-spin text-blue-600"}),e[17]||(e[17]=u(" 加载中 ",-1))]),e[18]||(e[18]=t("div",{class:"text-sm font-bold text-gray-800"},"正在获取活动记录...",-1))])])):C.value.length===0?(r(),l("div",Et,[...e[19]||(e[19]=[t("div",{class:"bg-brutal-orange border-4 border-blue-600 shadow-brutal-lg p-8 max-w-md mx-auto transform -rotate-1"},[t("h3",{class:"text-xl font-black text-gray-800 uppercase mb-4"},"📭 没有活动记录"),t("p",{class:"text-sm font-bold text-gray-800"}," 在所选时间范围内没有找到任何推送活动 ")],-1)])])):(r(),l("div",Pt,[(r(!0),l(U,null,H(R.value,(a,d)=>(r(),l("div",{key:d,class:"relative"},[t("div",{class:"flex items-center mb-4 cursor-pointer hover:bg-brutal-yellow hover:px-2 p-2 -mx-2 transition-all border-2 border-blue-600",onClick:c=>Te(d)},[t("div",Ht,[t("span",qt,b(be(d)?"►":"▼"),1),t("div",Gt,b(ye(d)),1)]),e[20]||(e[20]=t("div",{class:"flex-1 h-1 bg-blue-600 ml-4"},null,-1)),t("div",Yt,b(a.length)+" 个活动 ",1)],8,Ut),be(d)?p("",!0):(r(),l("div",Wt,[(r(!0),l(U,null,H(a,c=>(r(),l("div",{key:c.id||c.created_at,class:"relative border-4 border-blue-600 shadow-brutal bg-white p-4 hover:shadow-brutal-lg hover:transform hover:-translate-y-1 transition-all"},[t("div",Zt,[o(n(J),{class:"w-4 h-4"})]),t("div",Xt,[t("div",Jt,[t("div",Kt,[t("h3",Qt,b(c.action||"pushed to"),1),t("span",es,b(c.target_title||c.ref_name||"master"),1)]),c.note?(r(),l("p",ts,b(c.note),1)):p("",!0),c.commits&&c.commits.length?(r(),l("div",ss,[(r(!0),l(U,null,H(c.commits.slice(0,3),i=>(r(),l("div",{key:i.id,class:"text-xs text-gray-500 font-mono bg-gray-50 p-2 rounded"},[t("div",as,b(i.id?.substring(0,7)),1),t("div",rs,b(i.message),1)]))),128)),c.commits.length>3?(r(),l("div",os," 还有 "+b(c.commits.length-3)+" 个提交... ",1)):p("",!0)])):p("",!0)]),t("div",ls,[t("div",ns,b(ce(c.created_at)),1),c.author_name?(r(),l("div",cs,b(c.author_name),1)):p("",!0)])])]))),128))]))]))),128))]))])]),Q.value?(r(),l("div",{key:0,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",onClick:ie},[t("div",{class:"bg-white border-4 border-blue-600 shadow-brutal-lg max-w-4xl w-full max-h-[90vh] flex flex-col transform rotate-1 hover:rotate-0 transition-transform duration-300",onClick:e[3]||(e[3]=Be(()=>{},["stop"]))},[t("div",is,[t("h2",ds,[o(n(q),{class:"w-6 h-6 mr-3 text-blue-600"}),e[21]||(e[21]=u(" AI智能报告 ",-1))]),t("div",us,[t("button",{onClick:_e,disabled:_.value,class:"bg-brutal-green border-4 border-blue-600 shadow-brutal px-4 py-2 font-black text-gray-800 uppercase hover:transform hover:translate-x-1 hover:translate-y-1 hover:shadow-none transition-all disabled:opacity-50 disabled:cursor-not-allowed","data-ai-generate-btn":""},[o(n(q),{class:"w-4 h-4 mr-2 inline"}),u(" "+b(_.value?"生成中...":h.value?"重新生成":"生成报告"),1)],8,bs),t("button",{onClick:ie,class:"bg-brutal-red border-4 border-blue-600 shadow-brutal px-3 py-2 font-black text-gray-800 uppercase hover:transform hover:translate-x-1 hover:translate-y-1 hover:shadow-none transition-all"},[o(n(le),{class:"w-4 h-4"})])])]),t("div",ps,[!_.value&&!h.value?(r(),l("div",hs,[t("div",vs,[t("div",ms,[o(n(V),{class:"w-4 h-4 mr-2 text-blue-600"}),e[22]||(e[22]=u(" 预计耗时 30-60 秒 ",-1))])]),t("div",xs,[t("div",ys,[o(n(le),{class:"w-4 h-4 mr-2 text-blue-600"}),e[23]||(e[23]=u(" 开始生成后可关闭窗口，生成不会中断 ",-1))])]),t("div",fs,[t("div",gs,[t("h3",ws,[o(n(J),{class:"w-5 h-5 mr-2 text-blue-600"}),e[24]||(e[24]=u(" 信息补充 (可选) ",-1))]),ae(t("textarea",{"onUpdate:modelValue":e[2]||(e[2]=a=>B.value=a),placeholder:"您可以在这里补充项目背景信息、工作内容说明或其他需要AI了解的信息，以便生成更精准的报告...",class:"w-full h-32 p-4 border-4 border-blue-600 font-bold text-gray-800 text-sm resize-none focus:outline-none focus:bg-brutal-cyan placeholder:text-gray-500 placeholder:font-normal"},null,512),[[re,B.value]]),e[25]||(e[25]=t("div",{class:"mt-2 text-xs text-gray-600 font-bold"}," 提示：添加相关背景信息可以让AI生成更具体、更有价值的分析报告 ",-1))])]),t("div",ks,[o(n(q),{class:"w-16 h-16 text-blue-600 mb-4 mx-auto"}),t("h3",_s,[o(n(q),{class:"w-8 h-8 mr-3"}),e[26]||(e[26]=u(" AI智能报告 ",-1))]),e[28]||(e[28]=t("p",{class:"text-sm font-bold text-gray-800 mb-4"},"点击上方按钮生成智能分析报告",-1)),t("div",Ds,[o(n(oe),{class:"w-4 h-4 mr-2"}),e[27]||(e[27]=u(" AI将分析您的项目活动并生成详细报告 ",-1))])])])):p("",!0),_.value&&!h.value?(r(),l("div",Cs,[t("div",js,[e[30]||(e[30]=t("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-4 border-blue-600 border-t-transparent"},null,-1)),t("p",Ms,[o(n(oe),{class:"w-4 h-4 mr-2"}),e[29]||(e[29]=u(" 正在生成AI报告... ",-1))]),z.value?(r(),l("p",$s,[o(n(V),{class:"w-3 h-3 mr-1"}),u(" 已耗时: "+b(z.value),1)])):p("",!0)])])):h.value?(r(),l("div",Ts,[t("div",Ss,[t("div",null,[t("h3",Is,[o(n(J),{class:"w-5 h-5 mr-2"}),e[31]||(e[31]=u(" 报告内容 ",-1))]),t("div",As,[$.value?(r(),l("span",zs,[o(n(X),{class:"w-3 h-3 mr-1"}),u(" "+b($.value.toLocaleString("zh-CN")),1)])):p("",!0),z.value?(r(),l("span",Rs,[o(n(V),{class:"w-3 h-3 mr-1"}),u(" "+b(z.value),1)])):p("",!0)])]),t("div",Os,[t("button",{onClick:je,class:"bg-brutal-cyan border-4 border-blue-600 shadow-brutal-sm px-3 py-2 font-bold text-gray-800 uppercase hover:transform hover:translate-x-1 hover:translate-y-1 hover:shadow-none transition-all text-xs"},[o(n(Ke),{class:"w-3 h-3 mr-1 inline"}),e[32]||(e[32]=u(" 复制 ",-1))]),t("button",{onClick:Me,class:"bg-brutal-green border-4 border-blue-600 shadow-brutal-sm px-3 py-2 font-bold text-gray-800 uppercase hover:transform hover:translate-x-1 hover:translate-y-1 hover:shadow-none transition-all text-xs"},[o(n(J),{class:"w-3 h-3 mr-1 inline"}),e[33]||(e[33]=u(" 文本 ",-1))]),t("button",{onClick:$e,class:"bg-brutal-orange border-4 border-blue-600 shadow-brutal-sm px-3 py-2 font-bold text-gray-800 uppercase hover:transform hover:translate-x-1 hover:translate-y-1 hover:shadow-none transition-all text-xs"},[o(n(Qe),{class:"w-3 h-3 mr-1 inline"}),e[34]||(e[34]=u(" 下载 ",-1))])])]),t("div",{ref_key:"reportContainer",ref:he,class:"border-4 border-blue-600 shadow-brutal-sm p-6 overflow-auto max-h-96 scroll-smooth bg-white transform -rotate-1"},[_.value?(r(),l("div",Fs,[e[36]||(e[36]=t("div",{class:"bg-brutal-orange border-4 border-blue-600 shadow-brutal p-4 inline-block"},[t("div",{class:"animate-spin rounded-full h-8 w-8 border-4 border-blue-600 border-t-transparent"})],-1)),t("p",Ls,[o(n(oe),{class:"w-4 h-4 mr-2"}),e[35]||(e[35]=u(" 正在生成AI报告... ",-1))]),z.value?(r(),l("p",Vs,[o(n(V),{class:"w-3 h-3 mr-1"}),u(" "+b(z.value),1)])):p("",!0)])):(r(),l("div",Ns,b(h.value),1))],512)])):p("",!0)])])])):p("",!0),(r(),Ne(Ue,{to:"body"},[t("div",Bs,[o(Pe,{name:"toast",tag:"div"},{default:Ee(()=>[(r(!0),l(U,null,H(W.value,(a,d)=>(r(),l("div",{key:a.id,class:"bg-brutal-green border-4 border-blue-600 shadow-brutal overflow-hidden animate-fade-in toast-container min-w-[300px] max-w-[400px] transform hover:translate-x-1 hover:translate-y-1 hover:shadow-none transition-all",style:We({"z-index":99999-d,"margin-top":d>0?"0.5rem":"0",transform:`rotate(${d%2===0?"1deg":"-1deg"})`})},[(r(),l("div",{class:"countdown-bar bg-blue-600",key:"bar-"+a.id})),t("div",Es,[t("div",Ps,[o(n(Je),{class:"w-5 h-5 text-blue-600"})]),t("div",Us,[t("p",Hs,b(a.message),1)]),t("div",qs,[t("button",{onClick:c=>ue(a.id),class:"bg-brutal-red border-2 border-blue-600 shadow-brutal-sm px-2 py-1 font-bold text-gray-800 hover:transform hover:translate-x-1 hover:translate-y-1 hover:shadow-none transition-all"},[o(n(le),{class:"w-3 h-3"})],8,Gs)])])],4))),128))]),_:1})])]))]))}},Xs=ot(Ys,[["__scopeId","data-v-fd70345a"]]);export{Xs as default};
